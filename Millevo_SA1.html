<!DOCTYPE html>
<html>
<head>
  <title>FretMojo Appointment Booking</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <style>
    * {
    font-family: 'Poppins', sans-serif;
    box-sizing: border-box;
    }

    body {
    margin: 0;
    padding: 0;
    background-color: #e0e0e0;
    color: #333;
    }

    header {
    background-color: #111;
    color: #fff;
    padding: 2rem 1rem;
    text-align: center;
    }

    header img {
    height: 90px;
    width: 90px;
    border-radius: 50%;
    margin-bottom: 0.5rem;
    border: 3px solid maroon;
    }

    header h1 {
    margin: 0.2rem 0;
    color: maroon;
    }

    main {
    max-width: 900px;
    margin: 2rem auto;
    padding: 2rem;
    background-color: #fff;
    border: 2px solid #ccc;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    h2 {
    text-align: center;
    color: maroon;
    margin-bottom: 1.5rem;
    position: relative;
    }

    h2::after {
    content: "";
    display: block;
    width: 80px;
    margin: 0.5rem auto 0;
    border-bottom: 4px solid #f0b125;
    border-radius: 2px;
    }

    label {
    display: block;
    font-weight: bold;
    margin-top: 1rem;
    color: #222;
    }

    input, select, textarea {
    width: 100%;
    padding: 0.7rem;
    margin-top: 0.3rem;
    border: 1px solid #999;
    border-radius: 6px;
    background: #fdfdfd;
    transition: border 0.2s ease;
    }

    input:focus, select:focus, textarea:focus {
    border: 2px solid #f0b125;
    outline: none;
    }

    textarea {
    resize: vertical;
    }

    button {
    margin-top: 1.5rem;
    padding: 0.8rem 1rem;
    background-color: maroon;
    color: #fff;
    border: none;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
    transition: background 0.3s ease, box-shadow 0.3s ease;
    }

    button:hover {
    background-color: #a00000;
    box-shadow: 0 0 8px #f0b125aa;
    }

    button:focus {
    outline: 2px solid #f0b125;
    }

    #message {
    text-align: center;
    margin-top: 1rem;
    font-weight: bold;
    color: green;
    }

    table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 2rem;
    font-size: 0.95rem;
    }

    table thead {
    background-color: maroon;
    color: white;
    }

    table th, table td {
    padding: 0.75rem;
    border: 1px solid #ccc;
    text-align: left;
    }

    table tbody tr:nth-child(even) {
    background-color: #f5f5f5;
    }

    table tbody tr:hover {
    background-color: #fff8e6;
    }

    @media (max-width: 600px) {
    main {
        padding: 1rem;
    }

    table th, table td {
        font-size: 0.85rem;
    }
    }

</style>
</head>
<body>
  <header>
    <img src="https://scontent.fmnl33-1.fna.fbcdn.net/v/t39.30808-6/477541525_601927585926927_8662459802423187684_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeFJAxzm6uLD8BRTHULeUgzN0h_QxcbF_sTSH9DFxsX-xHBcdsjSK30bXWbVGqmaM-cCeMRmoSLpFek9fpsajYzE&_nc_ohc=tATnoSbqMA8Q7kNvwHxuLu_&_nc_oc=AdnyWj3r0Gu1i7xhrvIKazs2WYZgdCkN_4lHkjY4fFvaERj1vWHO1ZWVq0hRqOcyasg&_nc_zt=23&_nc_ht=scontent.fmnl33-1.fna&_nc_gid=PEsVjQpeP8Ppz5zZ5cXUbg&oh=00_AfMaabbDAFr7m5sC1QbBn2EF-LdxeYl2ugPzZKEegQp5Hg&oe=686D9D68" alt="FretMojo Profile" />
    <h1>FretMojo Guitar Repair</h1>
    <p>Book your repair appointment</p>
  </header>

  <main>
    <h2>Appointment Booking Form</h2>

    <form id="appointmentForm">
      <label>Name:</label>
      <input type="text" name="name" required>

      <label>Instrument Type:</label>
      <select name="instrument">
        <option value="Electric Guitar">Electric Guitar</option>
        <option value="Acoustic Guitar">Acoustic Guitar</option>
        <option value="Bass">Bass</option>
      </select>

      <label>Guitar Brand & Model:</label>
      <input type="text" name="brandModel" placeholder="e.g., Fender Stratocaster" required>

      <label>Preferred Date:</label>
      <input type="date" name="date" required>

      <label>Preferred Time:</label>
      <input type="time" name="time" required>

      <label>Contact Number:</label>
      <input type="tel" name="contact" required>

      <label>Reason for Appointment</label>
      <textarea name="reason" rows="4" placeholder="e.g., Fret buzz, setup, pickup installation..." required></textarea>

      <button type="submit">Book Appointment</button>
    </form>

    <div id="message"></div>

    <h3>Current Bookings</h3>
    <table id="bookingsTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Instrument</th>
          <th>Brand & Model</th>
          <th>Date</th>
          <th>Time</th>
          <th>Contact</th>
          <th>Reason</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <p style="text-align:center; margin-top: 1rem;">
      <a href="https://docs.google.com/spreadsheets/d/1_6NCo0EH1tCRB1INemeXHclXCBXvjylJ42hEUh6cbks/edit?usp=sharing" target="_blank">
        ðŸ“„ View Raw Google Sheet
      </a>
    </p>
  </main>

  <script>
    document.getElementById("appointmentForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = Object.fromEntries(formData);

      fetch("https://script.google.com/macros/s/AKfycbw25Qu1uQBY7p2yCyYkbXVHMJ9d_UDANmGg_GyLAeLnCa2RF0eNaKZtdnVlmqY-uYciQA/exec", {
        method: "POST",
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(msg => {
        document.getElementById("message").innerText = msg;
        e.target.reset();
        loadBookings();
      });
    });

    function loadBookings() {
      fetch("https://script.google.com/macros/s/AKfycbw25Qu1uQBY7p2yCyYkbXVHMJ9d_UDANmGg_GyLAeLnCa2RF0eNaKZtdnVlmqY-uYciQA/exec")
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#bookingsTable tbody");
          tbody.innerHTML = "";

          for (let i = 1; i < data.length; i++) {
            const row = data[i]; 
            const tr = document.createElement("tr");

            for (let j = 1; j < row.length; j++) { 
              const td = document.createElement("td");

              if (j === 4 && row[j]) {
                const formattedDate = new Date(row[j]).toLocaleDateString("en-PH", {
                  year: 'numeric', month: 'long', day: 'numeric'
                });
                td.textContent = formattedDate;
              }
              else if (j === 5 && row[j]) {
                const parsedTime = new Date(row[j]);
                if (!isNaN(parsedTime)) {
                  td.textContent = parsedTime.toLocaleTimeString("en-PH", {
                    hour: '2-digit', minute: '2-digit', hour12: true
                  });
                } else {
                  td.textContent = row[j];
                }
              } else {
                td.textContent = row[j];
              }

              tr.appendChild(td);
            }

            tbody.appendChild(tr);
          }
        });
    }
    loadBookings();
  </script>
</body>
</html>
